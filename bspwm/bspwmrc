#! /bin/sh

### Auto startup
if pgrep -x sxhkd > /dev/null; then
  pkill -USR1 -x sxhkd
else
  sxhkd &
fi

# numlock on
numlockx on &

# unlock kwallet
/usr/lib/pam_kwallet_init &

# display power management
xset s off &
xset dpms 0 0 1200 &

# screen locker
pgrep -x xautolock > /dev/null || xautolock -time 5 locker "$HOME/.config/i3/lock.sh" &

# redshift
pgrep -x redshift > /dev/null || redshift -l ${LATITUDE}:${LONGITUDE} &

# launch polybar
$HOME/.config/polybar/launch.sh &

# clipboard manager
pgrep -x klipper > /dev/null || klipper &

# dunst notifier
pgrep -x dunst > /dev/null || dunst &

# fcitx input method
pgrep -x ibus-daemon > /dev/null || ibus-daemon -drx --panel /usr/lib/ibus/ibus-ui-gtk3 &

# easystroke (mouse gesture)
pgrep -x easystroke > /dev/null || easystroke &

# set wallpaper
feh --bg-scale $HOME/.config/i3/bg.jpg &

# keyboard
$HOME/.config/i3/keyboard.sh &

# scrachpad konsole
if grep "gaps" ~/.config/i3/config > /dev/null; then
  rectangle=936x1032+968+40
else
  rectangle=960x1056+960+24
fi
bspc rule -a scratchkitty state=floating sticky=on hidden=on rectangle=$rectangle
pgrep -f scratchkitty > /dev/null || ~/.config/bspwm/scratchterm.sh hide &

### Set workspaces
bspc monitor -d 1 2 3 4 5 6 7 8 9 10

### Set windows
bspc config border_width         0

if grep "gaps" $HOME/.config/i3/config > /dev/null; then
  bspc config top_padding         24
  bspc config bottom_padding      -8
  bspc config window_gap          16
  bspc config split_ratio       0.50
else
  bspc config top_padding         24
  bspc config bottom_padding       0
  bspc config window_gap           0
  bspc config split_ratio       0.50
fi

bspc config borderless_monocle   true
bspc config gapless_monocle      true

### Set rules
bspc rule -a Rofi focus=on
bspc rule -a Screenkey manage=off
