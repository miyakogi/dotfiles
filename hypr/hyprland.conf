### Start Systemd Service ###
exec-once = systemctl --user import-environment DISAPLAY WAYLAND_DISPLAY && systemctl --user start user-graphical-session.target wlr-graphical-session.target hypr-graphical-session.target
exec-once = dbus-update-activation-environment --systemd --all && systemctl --user restart xdg-desktop-portal.service xdg-desktop-portal-wlr.service

### Source Colors ###
source=~/.config/hypr/catppuccin-mocha.conf

### Monitors ###
# See https://wiki.hyprland.org/Configuring/Monitors/
# monitor=DP-1,3840x2160@144,0x0,1.5
# monitor=DP-2,1920x1080@120,2560x100,1
# monitor=DP-1,3840x2160@144,0x0,1.333
# monitor=DP-2,1920x1080@120,2880x250,1
monitor=DP-1,3840x2160@144,0x0,1.25
monitor=DP-2,1920x1080@120,3072x324,1

misc {
  vfr = true
  vrr = 1  # 0: off, 1: on, 2: fullscreen only
  mouse_move_enables_dpms = true
  key_press_enables_dpms = true
  focus_on_activate = false
  disable_splash_rendering = true
}

xwayland {
  force_zero_scaling = true
}

### Status Bar ###
exec-once = waybar

### Wallpaper ###
exec-once = hyprpaper

### Cursor Theme ###
exec-once = hyprctl setcursor "$XCURSOR_THEME" "$XCURSOR_SIZE"

### Keyboard / Mouse ###
# For all categories, see https://wiki.hyprland.org/Configuring/Variables/
input {
  kb_layout = us
  kb_variant =
  kb_model =
  kb_rules =

  follow_mouse = 1

  repeat_delay = 300
  repeat_rate = 36

  touchpad {
    natural_scroll = false
  }
}

# for CoolerMaster MM720
device:cooler-master-technology-inc.-mm720-gaming-mouse {
  sensitivity = 0.0  # -1.0 - 1.0, 0 means no modification.
  accel_profile = flat
}

# for CoolerMaster MM710
device:cooler-master-technology-inc.-mm710-gaming-mouse {
  sensitivity = 0.0  # -1.0 - 1.0, 0 means no modification.
  accel_profile = flat
}

# For Glorious Model D
device:glorious-model-d {
  sensitivity = 0.0  # -1.0 - 1.0, 0 means no modification.
  accel_profile = flat
}

### Window Management ###
general {
  # See https://wiki.hyprland.org/Configuring/Variables/ for more

  gaps_in = 8
  gaps_out = 8
  border_size = 2
  col.active_border = $peach $red $sapphire $teal 45deg
  col.inactive_border = 0xaa$overlay2Alpha

  no_focus_fallback = true

  layout = master
}

decoration {
  # See https://wiki.hyprland.org/Configuring/Variables/ for more

  rounding = 3

  blur {
    enabled = true
    size = 5
    passes = 2
    new_optimizations = true
  }

  drop_shadow = false
  shadow_range = 24
  shadow_render_power = 3
  col.shadow = rgba(f5bde6ff)
  col.shadow_inactive = rgba(939ab7dd)

  dim_inactive = false
  dim_strength = 0.15
}

animations {
  enabled = true

  bezier = Linear, 0, 0, 1, 1
  bezier = easeInOutSine, 0, 0.69, 1, 0.43
  bezier = overInOutSine, 0, 0.3, -0.2, 1.3

  animation = windowsIn, 1, 1.2, overInOutSine, popin 20%
  animation = windowsOut, 1, 1.2, overInOutSine, popin 20%
  animation = windowsMove, 1, 1.2, overInOutSine, slide
  animation = border, 1, 1.2, Linear
  animation = borderangle, 1, 60, Linear, loop
  animation = fade, 0, 1, default
  animation = workspaces, 1, 1.2, Linear, slidefade 60%
}

dwindle {
  # See https://wiki.hyprland.org/Configuring/Dwindle-Layout/ for more
  pseudotile = false  # master switch for pseudotiling. Enabling is bound to mainMod + P in the keybinds section below
  preserve_split = false  # you probably want this
  force_split = 2  # 0 -> split follows mouse, 1 -> always split to the left (new = left or top), 2 -> always split to the right (new = right or bottom)
  no_gaps_when_only = false
}

master {
  # See https://wiki.hyprland.org/Configuring/Master-Layout/ for more
  new_is_master = false
  mfact = 0.58
}

### Keybinding ###
# See https://wiki.hyprland.org/Configuring/Keywords/ for more
$mainMod = SUPER

# Example binds, see https://wiki.hyprland.org/Configuring/Binds/ for more
bind = $mainMod, RETURN, exec, launch-foot
bind = $mainMod, Q, killactive
bind = $mainMod, W, killactive
bind = $mainMod SHIFT, E, exec, leave
bind = $mainMod SHIFT, R, exec, killall waybar && sleep 1 && waybar &
bind = $mainMod SHIFT, Space, exec, launch-terminal
bind = $mainMod, F, fullscreen
bind = $mainMod SHIFT, F, togglefloating
bind = $mainMod, D, exec, bash -c "if is-4k; then fuzzel -o DP-1; else fuzzel -o DP-2; fi"
bind = $mainMod, Z, exec, launch-menu
#bind = $mainMod, P, pseudo  # dwindle
bind = , F2, exec, hypr-scratchterm

# Move focus with mainMod + arrow keys
bind = $mainMod, H, movefocus, l
bind = $mainMod, L, movefocus, r
#bind = $mainMod, K, movefocus, u
#bind = $mainMod, J, movefocus, d

# Move window position
bind = $mainMod SHIFT, H, movewindow, l
bind = $mainMod SHIFT, L, movewindow, r
#bind = $mainMod SHIFT, K, movewindow, u
#bind = $mainMod SHIFT, J, movewindow, d

# Master layout specific
bind = $mainMod, SPACE, layoutmsg, swapwithmaster master
bind = $mainMod, J, layoutmsg, cyclenext
bind = $mainMod, K, layoutmsg, cycleprev
bind = $mainMod SHIFT, J, layoutmsg, swapnext
bind = $mainMod SHIFT, K, layoutmsg, swapprev

# Master tile mod
bind = $mainMod, PERIOD, layoutmsg, addmaster
bind = $mainMod, COMMA, layoutmsg, removemaster

# Rotate orientation
bind = $mainMod ALT, H, layoutmsg, orientationleft
bind = $mainMod ALT, L, layoutmsg, orientationright
bind = $mainMod ALT, J, layoutmsg, orientationbottom
bind = $mainMod ALT, K, layoutmsg, orientationtop

# Move focus to specific monitor
bind = $mainMod, left, focusmonitor, DP-1
bind = $mainMod, right, focusmonitor, DP-2

# Define workspace names
$ws01 = 1
$ws02 = 2
$ws03 = 3
$ws04 = 4
$ws05 = 5
$ws06 = 6
$ws07 = 7
$ws08 = 8
$ws09 = 9
$ws10 = 10
$ws11 = 11
$ws12 = 12
$ws13 = 13
$ws14 = 14
$ws15 = 15
$ws16 = 16
$ws17 = 17
$ws18 = 18
$ws19 = 19
$ws20 = 20

# Switch workspaces with mainMod + [0-9]
bind = $mainMod, 1, workspace, $ws01
bind = $mainMod, 2, workspace, $ws02
bind = $mainMod, 3, workspace, $ws03
bind = $mainMod, 4, workspace, $ws04
bind = $mainMod, 5, workspace, $ws05
bind = $mainMod, 6, workspace, $ws06
bind = $mainMod, 7, workspace, $ws07
bind = $mainMod, 8, workspace, $ws08
bind = $mainMod, 9, workspace, $ws09
bind = $mainMod, 0, workspace, $ws10
bind = $mainMod CONTROL, 1, workspace, $ws11
bind = $mainMod CONTROL, 2, workspace, $ws12
bind = $mainMod CONTROL, 3, workspace, $ws13
bind = $mainMod CONTROL, 4, workspace, $ws14
bind = $mainMod CONTROL, 5, workspace, $ws15
bind = $mainMod CONTROL, 6, workspace, $ws16
bind = $mainMod CONTROL, 7, workspace, $ws17
bind = $mainMod CONTROL, 8, workspace, $ws18
bind = $mainMod CONTROL, 9, workspace, $ws19
bind = $mainMod CONTROL, 0, workspace, $ws20

workspace = $ws01, monitor:DP-1
workspace = $ws02, monitor:DP-1
workspace = $ws03, monitor:DP-1
workspace = $ws04, monitor:DP-1
workspace = $ws05, monitor:DP-1
workspace = $ws06, monitor:DP-1
workspace = $ws07, monitor:DP-1
workspace = $ws08, monitor:DP-1
workspace = $ws09, monitor:DP-1
workspace = $ws10, monitor:DP-1
workspace = $ws11, monitor:DP-2
workspace = $ws12, monitor:DP-2
workspace = $ws13, monitor:DP-2
workspace = $ws14, monitor:DP-2
workspace = $ws15, monitor:DP-2
workspace = $ws16, monitor:DP-2
workspace = $ws17, monitor:DP-2
workspace = $ws18, monitor:DP-2
workspace = $ws19, monitor:DP-2
workspace = $ws20, monitor:DP-2

# Move active window to a workspace with mainMod + SHIFT + [0-9]
bind = $mainMod SHIFT, 1, movetoworkspace, $ws01
bind = $mainMod SHIFT, 2, movetoworkspace, $ws02
bind = $mainMod SHIFT, 3, movetoworkspace, $ws03
bind = $mainMod SHIFT, 4, movetoworkspace, $ws04
bind = $mainMod SHIFT, 5, movetoworkspace, $ws05
bind = $mainMod SHIFT, 6, movetoworkspace, $ws06
bind = $mainMod SHIFT, 7, movetoworkspace, $ws07
bind = $mainMod SHIFT, 8, movetoworkspace, $ws08
bind = $mainMod SHIFT, 9, movetoworkspace, $ws09
bind = $mainMod SHIFT, 0, movetoworkspace, $ws10
bind = $mainMod SHIFT CONTROL, 1, movetoworkspace, $ws11
bind = $mainMod SHIFT CONTROL, 2, movetoworkspace, $ws12
bind = $mainMod SHIFT CONTROL, 3, movetoworkspace, $ws13
bind = $mainMod SHIFT CONTROL, 4, movetoworkspace, $ws14
bind = $mainMod SHIFT CONTROL, 5, movetoworkspace, $ws15
bind = $mainMod SHIFT CONTROL, 6, movetoworkspace, $ws16
bind = $mainMod SHIFT CONTROL, 7, movetoworkspace, $ws17
bind = $mainMod SHIFT CONTROL, 8, movetoworkspace, $ws18
bind = $mainMod SHIFT CONTROL, 9, movetoworkspace, $ws19
bind = $mainMod SHIFT CONTROL, 0, movetoworkspace, $ws20

# Switch workspace
bind = $mainMod, bracketleft, workspace, m-1
bind = $mainMod, bracketright, workspace, m+1
bind = $mainMod CONTROL, left, workspace, m-1
bind = $mainMod CONTROL, right, workspace, m+1
bind = $mainMod, p, workspace, m-1
bind = $mainMod, n, workspace, m+1

# Scroll through existing workspaces with mainMod + scroll
bind = $mainMod, mouse_down, workspace, m-1
bind = $mainMod, mouse_up, workspace, m+1
# Switch workspace by side button
bind = , mouse:276, workspace, m-1
bind = , mouse:275, workspace, m+1

# Add new workspace at next lowest number workspace
bind = $mainMod, backslash, exec, hypr-addws
bind = $mainMod, a, exec, hypr-addws
bind = $mainMod, g, exec, hypr-addws
bind = $mainMod, semicolon, exec, hypr-addws

# Move/resize windows with mainMod + LMB/RMB and dragging
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow

# Screenshot
bind = , PRINT, exec, _grim_file="${XDG_PICTURES_DIR:-$HOME/Pictures}/screenshots/grim/grim-$(date +%Y%m%d-%H%M%S).jpg" && grim -t jpeg $_grim_file && notify-send -i camera "Screenshot saved to $(echo $_grim_file | sed "s|$HOME|~|")"
bind = SHIFT, PRINT, exec, _grim_file="${XDG_PICTURES_DIR:-$HOME/Pictures}/screenshots/grim/grim-$(date +%Y%m%d-%H%M%S).jpg" && echo $(hyprctl -j activewindow | jq -r '.at[0], .at[1], .size[0], .size[1]' | xargs printf '%d,%d %dx%d') | grim -g - -t jpeg $_grim_file && notify-send -i camera "Screenshot saved to $(echo $_grim_file | sed -r "s|$HOME|~|")"
bind = CONTROL, PRINT, exec, grim -g "$(slurp)" - | swappy -f -

# Image compression
bind = $mainMod, M, exec, sscomp

### Application Rules ###
# Launcher
windowrulev2 = float,class:^(sklauncher)$
windowrulev2 = center,class:^(sklauncher)$

# ScratchTerm
windowrulev2 = workspace special:scratchterm-dp1,class:^(scratchterm-dp1)$
windowrulev2 = workspace special:scratchterm-dp2,class:^(scratchterm-dp2)$

# Browser
windowrulev2 = workspace $ws01 silent,class:^(firefox)$
windowrulev2 = workspace $ws01 silent,class:^(vivaldi-stable)$
windowrulev2 = workspace $ws01 silent,class:^(Vivaldi-stable)$
windowrulev2 = tile,class:^(vivaldi-stable)$
windowrulev2 = tile,class:^(Vivaldi-stable)$
windowrulev2 = workspace $ws11 silent,class:^(cachy-browser)$
windowrulev2 = workspace $ws11 silent,class:^(microsoft-edge)$
windowrulev2 = workspace $ws11 silent,class:^(Microsoft-edge)$
windowrulev2 = workspace $ws12 silent,class:^([Cc]hromium)$
windowrulev2 = workspace $ws12 silent,class:^(thorium-browser)$
windowrulev2 = workspace $ws12 silent,class:^(Thorium-browser)$
windowrulev2 = workspace $ws13 silent,class:^(brave-browser)$
windowrulev2 = workspace $ws13 silent,class:^(Brave-browser)$
windowrulev2 = workspace $ws13 silent,class:^(Vivaldi-home)$
windowrulev2 = tile,class:^(Vivaldi-home)$
windowrulev2 = workspace $ws14 silent,class:^(discord)$
windowrulev2 = workspace $ws14 silent,class:^(ArmCord)$
windowrulev2 = workspace $ws14 silent,class:^(WebCord)$

# Music Player
windowrulev2 = workspace $ws09 silent,class:^(Spotify)$
windowrulev2 = tile,class:^(Spotify)$
windowrulev2 = workspace $ws09 silent,class:^(spotify-player)$
windowrulev2 = workspace $ws09 silent,class:^(audacious)$

# Steam / Proton
windowrulev2 = workspace $ws07 silent,class:^(steam)$
windowrulev2 = workspace $ws07 silent,class:^(steamwebhelper)$
windowrulev2 = workspace $ws07 silent,class:^(Steam)$
windowrulev2 = workspace $ws07 silent,title:^(ProtonUp-Qt)$
windowrulev2 = float,class:^(gamescope)$
windowrulev2 = noblur,class:^(gamescope)$
windowrulev2 = idleinhibit focus,class:^(gamescope)$
windowrulev2 = workspace $ws08 silent,class:^(gamescope)$
windowrulev2 = noblur,class:^(steam_app_.*)$
windowrulev2 = idleinhibit focus,class:^(steam_app_.*)$
windowrulev2 = workspace $ws08 silent,class:^(steam_app_.*)$
windowrulev2 = noblur,class:^(steam_proton)$
windowrulev2 = idleinhibit focus silent,class:^(steam_proton)$

# misc
windowrulev2 = float,class:^(pavucontrol-qt)$
windowrulev2 = float,class:^(XEyes)$

### Autostart
exec-once = spotify-player
exec-once = bash -c "zellij attach scratchterm-dp1 || zellij --session scratchterm-dp1"
exec-once = bash -c "zellij attach scratchterm-dp2 || zellij --session scratchterm-dp2"
